import{initializeApp,getApps}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";import{getAuth,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";import{getFirestore,doc,getDoc,setDoc,updateDoc,enableIndexedDbPersistence}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";const firebaseConfig={apiKey:"AIzaSyCZs2a35ENke7G8K7pzAMKCY3HOoi-IUcU",authDomain:"uxshari-670fd.firebaseapp.com",projectId:"uxshari-670fd",appId:"1:907540538791:web:ed98ef4ba51c96de43c282"};getApps().length||initializeApp(firebaseConfig);const auth=getAuth(),db=getFirestore();enableIndexedDbPersistence(db).catch(()=>{});const encEmail=e=>btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),projectTypes=[{id:"ecommerce",name:"é›»å•†å¹³å°",icon:"ğŸ›’",desc:"è³¼ç‰©ã€çµå¸³ã€ç‰©æµ",template:{process:[{id:"e_p1",text:"å•†å“æœå°‹åŠŸèƒ½æ˜¯å¦ç›´è¦ºï¼Ÿèƒ½å¦å¿«é€Ÿæ‰¾åˆ°ç›®æ¨™å•†å“ï¼Ÿ",checked:!1,suggestion:"å»ºè­°ï¼šåŠ å…¥æ™ºèƒ½æ¨è–¦ã€ç¯©é¸æ¢ä»¶"},{id:"e_p2",text:"åŠ å…¥è³¼ç‰©è»Šæµç¨‹æ˜¯å¦é †æš¢ï¼Ÿ",checked:!1,suggestion:"åƒè€ƒï¼šä¸€éµåŠ è³¼ã€æ‰¹é‡é¸è³¼"},{id:"e_p3",text:"çµå¸³æ­¥é©Ÿæ˜¯å¦éæ–¼è¤‡é›œï¼Ÿéœ€è¦å¤šå°‘æ­¥é©Ÿå®Œæˆï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šæ¸›å°‘è¡¨å–®æ¬„ä½ã€æ”¯æ´å¿«é€Ÿçµå¸³"},{id:"e_p4",text:"ä»˜æ¬¾æ–¹å¼æ˜¯å¦å¤šå…ƒï¼Ÿï¼ˆä¿¡ç”¨å¡ã€è½‰å¸³ã€ç¬¬ä¸‰æ–¹æ”¯ä»˜ï¼‰",checked:!1,suggestion:"æä¾›ï¼šå¤šç¨®æ”¯ä»˜é¸é …æå‡è½‰æ›ç‡"},{id:"e_p5",text:"è¨‚å–®è¿½è¹¤èˆ‡é€€è²¨æµç¨‹æ˜¯å¦æ¸…æ™°ï¼Ÿ",checked:!1,suggestion:"å¿…å‚™ï¼šå³æ™‚ç‰©æµè¿½è¹¤ã€ç°¡æ˜“é€€è²¨æ”¿ç­–"}],interface:[{id:"e_i1",text:"å•†å“åœ–ç‰‡æ˜¯å¦æ¸…æ™°ï¼Ÿæ”¯æ´å¤šè§’åº¦æª¢è¦–ï¼Ÿ",checked:!1,suggestion:"å»ºè­°ï¼š360åº¦æª¢è¦–ã€æ”¾å¤§åŠŸèƒ½"},{id:"e_i2",text:"å•†å“æè¿°æ˜¯å¦å®Œæ•´ï¼Ÿï¼ˆè¦æ ¼ã€å°ºå¯¸ã€æè³ªï¼‰",checked:!1,suggestion:"å„ªåŒ–ï¼šçµæ§‹åŒ–æè¿°ã€å°æ¯”è¡¨æ ¼"},{id:"e_i3",text:"åƒ¹æ ¼ã€æŠ˜æ‰£é¡¯ç¤ºæ˜¯å¦æ¸…æ¥šï¼Ÿ",checked:!1,suggestion:"é€æ˜ï¼šåŸåƒ¹ã€æŠ˜æ‰£ã€é‹è²»ä¸€ç›®äº†ç„¶"},{id:"e_i4",text:"è³¼ç‰©è»Šåœ–ç¤ºèˆ‡å•†å“æ•¸é‡æç¤ºæ˜¯å¦æ˜é¡¯ï¼Ÿ",checked:!1,suggestion:"è¨­è¨ˆï¼šå›ºå®šæ‡¸æµ®æŒ‰éˆ•ã€æ•¸å­—å¾½ç« "},{id:"e_i5",text:"è¡Œå‹•ç‰ˆå•†å“å¡ç‰‡æ˜¯å¦æ˜“æ–¼ç€è¦½èˆ‡é»æ“Šï¼Ÿ",checked:!1,suggestion:"éŸ¿æ‡‰å¼ï¼šå¤§ç¸®åœ–ã€æ¸…æ™°CTA"}],context:[{id:"e_c1",text:"é¦–æ¬¡è¨ªå®¢èƒ½å¦å¿«é€Ÿç†è§£ç¶²ç«™è³£ä»€éº¼ï¼Ÿ",checked:!1,suggestion:"é¦–é ï¼šæ¸…æ™°åƒ¹å€¼ä¸»å¼µã€ç†±é–€å•†å“"},{id:"e_c2",text:"æ˜¯å¦æä¾›å®¢æœç®¡é“ï¼Ÿï¼ˆç·šä¸Šå®¢æœã€FAQï¼‰",checked:!1,suggestion:"å³æ™‚ï¼šèŠå¤©æ©Ÿå™¨äººã€å¸¸è¦‹å•é¡Œ"},{id:"e_c3",text:"ç¶²ç«™è¼‰å…¥é€Ÿåº¦æ˜¯å¦å¤ å¿«ï¼Ÿï¼ˆç‰¹åˆ¥æ˜¯å•†å“åœ–ç‰‡ï¼‰",checked:!1,suggestion:"å„ªåŒ–ï¼šåœ–ç‰‡å£“ç¸®ã€CDNåŠ é€Ÿ"},{id:"e_c4",text:"æ˜¯å¦æ”¯æ´è¨ªå®¢çµå¸³ï¼Ÿï¼ˆç„¡éœ€å¼·åˆ¶è¨»å†Šï¼‰",checked:!1,suggestion:"å½ˆæ€§ï¼šè¨ªå®¢çµå¸³é™ä½é–€æª»"},{id:"e_c5",text:"æ˜¯å¦æœ‰ä¿¡ä»»æŒ‡æ¨™ï¼Ÿï¼ˆè©•è«–ã€èªè­‰ã€é€€æ¬¾ä¿è­‰ï¼‰",checked:!1,suggestion:"å»ºç«‹ä¿¡ä»»ï¼šç”¨æˆ¶è©•åƒ¹ã€å®‰å…¨æ¨™ç« "}],cognitive:[{id:"e_cg1",text:"å•†å“è³‡è¨Šæ˜¯å¦éå¤šï¼Œé€ æˆä½¿ç”¨è€…ç„¡æ³•èšç„¦ï¼Ÿ",checked:!1,suggestion:"åˆ†æ®µå‘ˆç¾ã€é€æ­¥é¡¯ç¤º"},{id:"e_cg2",text:"å•†å“åˆ†é¡èˆ‡æ¶æ§‹æ˜¯å¦æ¸…æ™°ï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šå¤šå±¤åˆ†é¡ã€éºµåŒ…å±‘å°èˆª"},{id:"e_cg3",text:"ç”¨èªæ˜¯å¦ä¸€è‡´ï¼Ÿæ˜¯å¦å­˜åœ¨å°ˆæ¥­è¡“èªæˆ–ç¿»è­¯å•é¡Œï¼Ÿ",checked:!1,suggestion:"å»ºç«‹ç”¨èªå­—å…¸ã€çµ±ä¸€ç¿»è­¯"},{id:"e_cg4",text:"è³¼ç‰©æµç¨‹æ˜¯å¦ç¬¦åˆä½¿ç”¨è€…çš„èªçŸ¥æ¨¡å‹ï¼Ÿ",checked:!1,suggestion:"åƒè€ƒå¸¸è¦‹æ¨¡å¼ã€é™ä½å­¸ç¿’æˆæœ¬"},{id:"e_cg5",text:"æ˜¯å¦æä¾›è¶³å¤ çš„å¼•å°èˆ‡èªªæ˜ï¼Ÿ",checked:!1,suggestion:"å·¥å…·æç¤ºã€é€æ­¥æ•™å­¸"}],emotional:[{id:"e_em1",text:"ä½¿ç”¨è€…æ˜¯å¦åœ¨çµå¸³éç¨‹ä¸­æ„Ÿåˆ°ç„¦æ…®æˆ–ä¸ç¢ºå®šï¼Ÿ",checked:!1,suggestion:"å³æ™‚å›é¥‹ã€æ¸…æ¥šéŒ¯èª¤è¨Šæ¯"},{id:"e_em2",text:"æ˜¯å¦æœ‰éŒ¯èª¤è™•ç†ä¸æ¸…æ¥šï¼Œé€ æˆæŒ«æŠ˜æ„Ÿï¼Ÿ",checked:!1,suggestion:"å…·é«”ä¿®æ­£å»ºè­°ã€é‡è©¦é¸é …"},{id:"e_em3",text:"ç­‰å¾…ç‰©æµæˆ–ä»˜æ¬¾ç¢ºèªæ˜¯å¦å°è‡´å¤±æœ›ï¼Ÿ",checked:!1,suggestion:"éª¨æ¶å±ã€é€²åº¦æç¤º"},{id:"e_em4",text:"æ˜¯å¦æœ‰äº’å‹•è¨­è¨ˆè®“ä½¿ç”¨è€…æ„Ÿåˆ°è¢«å¿½ç•¥ï¼Ÿ",checked:!1,suggestion:"ç¢ºèªæ“ä½œæˆåŠŸã€å›é¥‹å‹•ç•«"},{id:"e_em5",text:"æ˜¯å¦æœ‰æƒ…å¢ƒè¨­è¨ˆè®“ä½¿ç”¨è€…æ„Ÿåˆ°ä¸è¢«å°Šé‡æˆ–ç†è§£ï¼Ÿ",checked:!1,suggestion:"æ–‡åŒ–æ•æ„Ÿè¨­è¨ˆã€åŒ…å®¹æ€§æ–‡æ¡ˆ"}]}},{id:"education",name:"æ•™è‚²å¹³å°",icon:"ğŸ“š",desc:"èª²ç¨‹ã€å­¸ç¿’ã€é€²åº¦",template:{process:[{id:"ed_p1",text:"èª²ç¨‹æœå°‹èˆ‡ç¯©é¸æ˜¯å¦ç›´è¦ºï¼Ÿ",checked:!1,suggestion:"å»ºè­°ï¼šä¾é¡åˆ¥ã€é›£åº¦ã€è©•åˆ†ç¯©é¸"},{id:"ed_p2",text:"è¨»å†Š/ç™»å…¥æµç¨‹æ˜¯å¦ç°¡æ½”ï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šç¤¾ç¾¤ç™»å…¥ã€å–®é è¨»å†Š"},{id:"ed_p3",text:"è³¼è²·èª²ç¨‹æµç¨‹æ˜¯å¦é †æš¢ï¼Ÿ",checked:!1,suggestion:"ç°¡åŒ–ï¼šå¿«é€Ÿçµå¸³ã€è©¦çœ‹åŠŸèƒ½"},{id:"ed_p4",text:"å­¸ç¿’é€²åº¦æ˜¯å¦èƒ½è‡ªå‹•å„²å­˜èˆ‡åŒæ­¥ï¼Ÿ",checked:!1,suggestion:"å¿…å‚™ï¼šè·¨è£ç½®å­¸ç¿’é€²åº¦åŒæ­¥"},{id:"ed_p5",text:"ä½œæ¥­æäº¤èˆ‡æ‰¹æ”¹æµç¨‹æ˜¯å¦æ¸…æ¥šï¼Ÿ",checked:!1,suggestion:"æ˜ç¢ºï¼šæˆªæ­¢æ—¥æœŸã€æäº¤ç‹€æ…‹"}],interface:[{id:"ed_i1",text:"èª²ç¨‹å°èˆªæ˜¯å¦æ¸…æ™°ï¼Ÿï¼ˆç« ç¯€ã€å–®å…ƒï¼‰",checked:!1,suggestion:"è¨­è¨ˆï¼šå´é‚Šæ¬„ç›®éŒ„ã€é€²åº¦æ¢"},{id:"ed_i2",text:"å½±ç‰‡æ’­æ”¾å™¨æ˜¯å¦æ˜“ç”¨ï¼Ÿï¼ˆé€Ÿåº¦èª¿æ•´ã€å­—å¹•ï¼‰",checked:!1,suggestion:"åŠŸèƒ½ï¼šå€é€Ÿæ’­æ”¾ã€é‡é»ç­†è¨˜"},{id:"ed_i3",text:"å­¸ç¿’å„€è¡¨æ¿æ˜¯å¦ä¸€ç›®äº†ç„¶ï¼Ÿ",checked:!1,suggestion:"è¦–è¦ºï¼šå­¸ç¿’æ™‚æ•¸ã€å®Œæˆèª²ç¨‹ã€æˆå°±"},{id:"ed_i4",text:"èª²ç¨‹è³‡æ–™ä¸‹è¼‰æ˜¯å¦æ–¹ä¾¿ï¼Ÿï¼ˆè¬›ç¾©ã€ä½œæ¥­ï¼‰",checked:!1,suggestion:"ä¾¿åˆ©ï¼šä¸€éµä¸‹è¼‰å…¨éƒ¨è³‡æ–™"},{id:"ed_i5",text:"è¨è«–å€èˆ‡å•ç­”åŠŸèƒ½æ˜¯å¦æ˜“æ–¼ä½¿ç”¨ï¼Ÿ",checked:!1,suggestion:"äº’å‹•ï¼šæ¨™ç±¤åˆ†é¡ã€æœå°‹åŠŸèƒ½"}],context:[{id:"ed_c1",text:"æ–°å­¸å“¡èƒ½å¦å¿«é€Ÿæ‰¾åˆ°é©åˆçš„èª²ç¨‹ï¼Ÿ",checked:!1,suggestion:"å¼•å°ï¼šæ¨è–¦ç³»çµ±ã€å­¸ç¿’è·¯å¾‘"},{id:"ed_c2",text:"æ˜¯å¦æä¾›è©¦çœ‹æˆ–å…è²»èª²ç¨‹ï¼Ÿ",checked:!1,suggestion:"é™ä½é–€æª»ï¼šè©¦çœ‹ 10åˆ†é˜"},{id:"ed_c3",text:"æ˜¯å¦æ”¯æ´é›¢ç·šå­¸ç¿’ï¼Ÿ",checked:!1,suggestion:"å½ˆæ€§ï¼šä¸‹è¼‰èª²ç¨‹é›¢ç·šè§€çœ‹"},{id:"ed_c4",text:"æ˜¯å¦æœ‰å­¸ç¿’æé†’èˆ‡æ¿€å‹µæ©Ÿåˆ¶ï¼Ÿ",checked:!1,suggestion:"æŒçºŒå­¸ç¿’ï¼šæ¯æ—¥æé†’ã€æˆå°±å¾½ç« "},{id:"ed_c5",text:"è¡Œå‹•è£ç½®å­¸ç¿’é«”é©—æ˜¯å¦æµæš¢ï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šéŸ¿æ‡‰å¼è¨­è¨ˆã€è§¸æ§å‹å–„"}],cognitive:[{id:"ed_cg1",text:"èª²ç¨‹è³‡è¨Šæ˜¯å¦éå¤šï¼Œé€ æˆå­¸å“¡ç„¡æ³•èšç„¦ï¼Ÿ",checked:!1,suggestion:"åˆ†æ®µå‘ˆç¾ã€é€æ­¥é¡¯ç¤º"},{id:"ed_cg2",text:"èª²ç¨‹æ¶æ§‹æ˜¯å¦æ¸…æ™°ï¼Ÿç« ç¯€èˆ‡å–®å…ƒæ˜¯å¦å®¹æ˜“ç†è§£ï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šæ¨¹ç‹€çµæ§‹ã€é€²åº¦å°è¦½"},{id:"ed_cg3",text:"ç”¨èªæ˜¯å¦ä¸€è‡´ï¼Ÿæ˜¯å¦å­˜åœ¨å°ˆæ¥­è¡“èªæˆ–ç¿»è­¯å•é¡Œï¼Ÿ",checked:!1,suggestion:"å»ºç«‹ç”¨èªå­—å…¸ã€çµ±ä¸€ç¿»è­¯"},{id:"ed_cg4",text:"å­¸ç¿’æµç¨‹æ˜¯å¦ç¬¦åˆå­¸å“¡çš„èªçŸ¥æ¨¡å‹ï¼Ÿ",checked:!1,suggestion:"åƒè€ƒå¸¸è¦‹å­¸ç¿’æ¨¡å¼ã€é™ä½å­¸ç¿’æˆæœ¬"},{id:"ed_cg5",text:"æ˜¯å¦æä¾›è¶³å¤ çš„å¼•å°èˆ‡èªªæ˜ï¼Ÿ",checked:!1,suggestion:"å·¥å…·æç¤ºã€é€æ­¥æ•™å­¸"}],emotional:[{id:"ed_em1",text:"å­¸å“¡æ˜¯å¦åœ¨å­¸ç¿’éç¨‹ä¸­æ„Ÿåˆ°ç„¦æ…®æˆ–ä¸ç¢ºå®šï¼Ÿ",checked:!1,suggestion:"å³æ™‚å›é¥‹ã€æ¸…æ¥šéŒ¯èª¤è¨Šæ¯"},{id:"ed_em2",text:"æ˜¯å¦æœ‰ä½œæ¥­æˆ–è€ƒè©¦å£“åŠ›éå¤§ï¼Œé€ æˆæŒ«æŠ˜æ„Ÿï¼Ÿ",checked:!1,suggestion:"å½ˆæ€§ï¼šåˆ†æ®µæ¸¬é©—ã€å³æ™‚æç¤º"},{id:"ed_em3",text:"ç­‰å¾…æ‰¹æ”¹æˆ–å›è¦†æ˜¯å¦å°è‡´å¤±æœ›ï¼Ÿ",checked:!1,suggestion:"æ”¹å–„ï¼šè‡ªå‹•æ‰¹æ”¹ã€å¿«é€Ÿå›è¦†"},{id:"ed_em4",text:"æ˜¯å¦æœ‰äº’å‹•è¨­è¨ˆè®“å­¸å“¡æ„Ÿåˆ°è¢«å¿½ç•¥ï¼Ÿ",checked:!1,suggestion:"è¨­è¨ˆï¼šå³æ™‚äº’å‹•ã€å°å¸«å›é¥‹"},{id:"ed_em5",text:"æ˜¯å¦æœ‰æƒ…å¢ƒè¨­è¨ˆè®“å­¸å“¡æ„Ÿåˆ°ä¸è¢«å°Šé‡æˆ–ç†è§£ï¼Ÿ",checked:!1,suggestion:"æ–‡åŒ–æ•æ„Ÿè¨­è¨ˆã€åŒ…å®¹æ€§æ–‡æ¡ˆ"}]}},{id:"onboarding",name:"App å¼•å°",icon:"ğŸš€",desc:"æ–°æ‰‹æ•™å­¸ã€æ¬Šé™",template:{process:[{id:"ob_p1",text:"é¦–æ¬¡å•Ÿå‹•æ™‚ï¼Œåƒ¹å€¼ä¸»å¼µæ˜¯å¦æ¸…æ™°ï¼Ÿ",checked:!1,suggestion:"å»ºè­°ï¼š3ç§’å…§èªªæ˜æ ¸å¿ƒåƒ¹å€¼"},{id:"ob_p2",text:"è¨»å†Šæµç¨‹æ˜¯å¦ç°¡æ½”ï¼Ÿï¼ˆ3æ­¥é©Ÿå…§å®Œæˆï¼‰",checked:!1,suggestion:"å„ªåŒ–ï¼šå»¶å¾Œéå¿…è¦è³‡è¨Šæ”¶é›†"},{id:"ob_p3",text:"å¼•å°æµç¨‹æ˜¯å¦å¯è·³éï¼Ÿ",checked:!1,suggestion:"å½ˆæ€§ï¼šæä¾›ã€Œè·³éã€é¸é …"},{id:"ob_p4",text:"æ¬Šé™è«‹æ±‚æ˜¯å¦åœ¨é©ç•¶æ™‚æ©Ÿå‡ºç¾ï¼Ÿ",checked:!1,suggestion:"æ™‚æ©Ÿï¼šç”¨åˆ°æ‰è«‹æ±‚ï¼Œèªªæ˜åŸå› "},{id:"ob_p5",text:"å®Œæˆå¼•å°å¾Œï¼Œä½¿ç”¨è€…æ˜¯å¦çŸ¥é“ä¸‹ä¸€æ­¥ï¼Ÿ",checked:!1,suggestion:"æ˜ç¢ºï¼šCTA å¼•å°ç¬¬ä¸€å€‹è¡Œå‹•"}],interface:[{id:"ob_i1",text:"å¼•å°ç•«é¢æ˜¯å¦è¦–è¦ºå‹å–„ï¼Ÿï¼ˆæ’åœ–ã€å‹•ç•«ï¼‰",checked:!1,suggestion:"è¨­è¨ˆï¼šç°¡æ½”æ’åœ–ã€æµæš¢å‹•ç•«"},{id:"ob_i2",text:"é€²åº¦æŒ‡ç¤ºå™¨æ˜¯å¦æ¸…æ¥šï¼Ÿï¼ˆç¬¬å¹¾æ­¥/å…±å¹¾æ­¥ï¼‰",checked:!1,suggestion:"è¦–è¦ºï¼šé€²åº¦é»ã€ç™¾åˆ†æ¯”"},{id:"ob_i3",text:"æ–‡å­—èªªæ˜æ˜¯å¦ç°¡æ½”æ˜“æ‡‚ï¼Ÿï¼ˆé¿å…å°ˆæ¥­è¡“èªï¼‰",checked:!1,suggestion:"æ–‡æ¡ˆï¼šå£èªåŒ–ã€é—œæ³¨åˆ©ç›Šé»"},{id:"ob_i4",text:"æŒ‰éˆ•è¨­è¨ˆæ˜¯å¦æ˜ç¢ºï¼Ÿï¼ˆç¹¼çºŒã€è·³éã€å®Œæˆï¼‰",checked:!1,suggestion:"æ¸…æ™°ï¼šä¸»è¦CTAçªå‡º"},{id:"ob_i5",text:"æ˜¯å¦æ”¯æ´æ‰‹å‹¢æ“ä½œï¼Ÿï¼ˆæ»‘å‹•åˆ‡æ›ï¼‰",checked:!1,suggestion:"äº’å‹•ï¼šæ»‘å‹•æ›é ã€é»æ“Šè·³è½‰"}],context:[{id:"ob_c1",text:"å¼•å°å…§å®¹æ˜¯å¦èƒ½å€‹äººåŒ–ï¼Ÿï¼ˆä¾ç”¨æˆ¶é¡å‹ï¼‰",checked:!1,suggestion:"æ™ºèƒ½ï¼šä¾ä½¿ç”¨æƒ…å¢ƒèª¿æ•´"},{id:"ob_c2",text:"æ˜¯å¦æä¾›äº’å‹•å¼æ•™å­¸ï¼Ÿï¼ˆè€Œéç´”æ–‡å­—ï¼‰",checked:!1,suggestion:"é«”é©—ï¼šè®“ç”¨æˆ¶å¯¦éš›æ“ä½œ"},{id:"ob_c3",text:"å¼•å°çµæŸå¾Œï¼Œæ˜¯å¦å¯é‡æ–°æŸ¥çœ‹ï¼Ÿ",checked:!1,suggestion:"å¹«åŠ©ï¼šè¨­å®šä¸­æä¾›æ•™å­¸é‡æ’­"},{id:"ob_c4",text:"é¦–æ¬¡ä½¿ç”¨æ˜¯å¦æœ‰ç¯„ä¾‹è³‡æ–™ï¼Ÿ",checked:!1,suggestion:"é™ä½é–€æª»ï¼šé è¼‰ç¯„ä¾‹å…§å®¹"},{id:"ob_c5",text:"æ˜¯å¦è¿½è¹¤å¼•å°å®Œæˆç‡ï¼Ÿï¼ˆå„ªåŒ–å¼±é»ï¼‰",checked:!1,suggestion:"æ•¸æ“šï¼šåˆ†ææµå¤±æ­¥é©Ÿ"}],cognitive:[{id:"ob_cg1",text:"å¼•å°è³‡è¨Šæ˜¯å¦éå¤šï¼Œé€ æˆä½¿ç”¨è€…ç„¡æ³•èšç„¦ï¼Ÿ",checked:!1,suggestion:"åˆ†æ®µå‘ˆç¾ã€é€æ­¥é¡¯ç¤º"},{id:"ob_cg2",text:"å¼•å°æ¶æ§‹æ˜¯å¦æ¸…æ™°ï¼Ÿä½¿ç”¨è€…èƒ½å¦ç†è§£æµç¨‹å±¤ç´šï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šæ­¥é©Ÿåˆ†çµ„ã€é€²åº¦å°è¦½"},{id:"ob_cg3",text:"ç”¨èªæ˜¯å¦ä¸€è‡´ï¼Ÿæ˜¯å¦å­˜åœ¨å°ˆæ¥­è¡“èªæˆ–ç¿»è­¯å•é¡Œï¼Ÿ",checked:!1,suggestion:"å»ºç«‹ç”¨èªå­—å…¸ã€çµ±ä¸€ç¿»è­¯"},{id:"ob_cg4",text:"å¼•å°æµç¨‹æ˜¯å¦ç¬¦åˆä½¿ç”¨è€…çš„èªçŸ¥æ¨¡å‹ï¼Ÿ",checked:!1,suggestion:"åƒè€ƒå¸¸è¦‹æ¨¡å¼ã€é™ä½å­¸ç¿’æˆæœ¬"},{id:"ob_cg5",text:"æ˜¯å¦æä¾›è¶³å¤ çš„å¼•å°èˆ‡èªªæ˜ï¼Ÿ",checked:!1,suggestion:"å·¥å…·æç¤ºã€é€æ­¥æ•™å­¸"}],emotional:[{id:"ob_em1",text:"ä½¿ç”¨è€…æ˜¯å¦åœ¨å¼•å°éç¨‹ä¸­æ„Ÿåˆ°ç„¦æ…®æˆ–ä¸ç¢ºå®šï¼Ÿ",checked:!1,suggestion:"å³æ™‚å›é¥‹ã€æ¸…æ¥šéŒ¯èª¤è¨Šæ¯"},{id:"ob_em2",text:"æ˜¯å¦æœ‰éå¤šæ­¥é©Ÿé€ æˆæŒ«æŠ˜æ„Ÿï¼Ÿ",checked:!1,suggestion:"ç°¡åŒ–ï¼šæ¸›å°‘æ­¥é©Ÿã€æä¾›è·³éé¸é …"},{id:"ob_em3",text:"ç­‰å¾…æˆ–é‡è¤‡æ“ä½œæ˜¯å¦å°è‡´å¤±æœ›ï¼Ÿ",checked:!1,suggestion:"æ”¹å–„ï¼šé€²åº¦æç¤ºã€é¿å…é‡è¤‡è¼¸å…¥"},{id:"ob_em4",text:"æ˜¯å¦æœ‰äº’å‹•è¨­è¨ˆè®“ä½¿ç”¨è€…æ„Ÿåˆ°è¢«å¿½ç•¥ï¼Ÿ",checked:!1,suggestion:"è¨­è¨ˆï¼šç¢ºèªæ“ä½œæˆåŠŸã€å›é¥‹å‹•ç•«"},{id:"ob_em5",text:"å¼•å°å…§å®¹æ˜¯å¦è®“ä½¿ç”¨è€…æ„Ÿåˆ°ä¸è¢«å°Šé‡æˆ–ç†è§£ï¼Ÿ",checked:!1,suggestion:"æ–‡åŒ–æ•æ„Ÿè¨­è¨ˆã€åŒ…å®¹æ€§æ–‡æ¡ˆ"}]}},{id:"saas",name:"SaaS å·¥å…·",icon:"âš™ï¸",desc:"å”ä½œã€è¨‚é–±ã€å„€è¡¨æ¿",template:{process:[{id:"saas_p1",text:"å…è²»è©¦ç”¨æµç¨‹æ˜¯å¦ç°¡å–®ï¼Ÿï¼ˆç„¡éœ€ä¿¡ç”¨å¡ï¼‰",checked:!1,suggestion:"é™ä½é–€æª»ï¼šå…å¡è©¦ç”¨"},{id:"saas_p2",text:"è³‡æ–™åŒ¯å…¥/åŒ¯å‡ºæ˜¯å¦æ–¹ä¾¿ï¼Ÿ",checked:!1,suggestion:"å¿…å‚™ï¼šæ”¯æ´å¤šç¨®æ ¼å¼"},{id:"saas_p3",text:"åœ˜éšŠå”ä½œé‚€è«‹æµç¨‹æ˜¯å¦é †æš¢ï¼Ÿ",checked:!1,suggestion:"ä¾¿åˆ©ï¼šEmail é‚€è«‹ã€è§’è‰²ç®¡ç†"},{id:"saas_p4",text:"è¨‚é–±å‡ç´š/é™ç´šæµç¨‹æ˜¯å¦æ¸…æ¥šï¼Ÿ",checked:!1,suggestion:"é€æ˜ï¼šæ–¹æ¡ˆæ¯”è¼ƒã€ç„¡ç—›åˆ‡æ›"},{id:"saas_p5",text:"å–æ¶ˆè¨‚é–±æ˜¯å¦å®¹æ˜“ï¼Ÿï¼ˆä¸åˆ»æ„åˆé›£ï¼‰",checked:!1,suggestion:"èª ä¿¡ï¼šç°¡å–®å–æ¶ˆå»ºç«‹ä¿¡ä»»"}],interface:[{id:"saas_i1",text:"å„€è¡¨æ¿æ˜¯å¦æ¸…æ™°å±•ç¤ºé—œéµæ•¸æ“šï¼Ÿ",checked:!1,suggestion:"è¨­è¨ˆï¼šå¡ç‰‡å¼å¸ƒå±€ã€åœ–è¡¨è¦–è¦ºåŒ–"},{id:"saas_i2",text:"è¨­å®šé¸é …æ˜¯å¦æ˜“æ–¼æ‰¾åˆ°èˆ‡èª¿æ•´ï¼Ÿ",checked:!1,suggestion:"çµ„ç¹”ï¼šåˆ†é¡æ¸…æ¥šã€æœå°‹åŠŸèƒ½"},{id:"saas_i3",text:"é€šçŸ¥ç³»çµ±æ˜¯å¦ä¸éåº¦æ‰“æ“¾ï¼Ÿ",checked:!1,suggestion:"å¹³è¡¡ï¼šé‡è¦é€šçŸ¥ã€å¯è‡ªè¨‚"},{id:"saas_i4",text:"æœå°‹åŠŸèƒ½æ˜¯å¦å¼·å¤§ä¸”å¿«é€Ÿï¼Ÿ",checked:!1,suggestion:"å¿…å‚™ï¼šå…¨å±€æœå°‹ã€å¿«æ·éµ"},{id:"saas_i5",text:"æ·±è‰²æ¨¡å¼æ”¯æ´æ˜¯å¦å®Œæ•´ï¼Ÿ",checked:!1,suggestion:"é«”é©—ï¼šä¿è­·è¦–åŠ›ã€ç¯€çœé›»åŠ›"}],context:[{id:"saas_c1",text:"ç”¢å“å°è¦½æ˜¯å¦é‡å°ä¸åŒè§’è‰²ï¼Ÿ",checked:!1,suggestion:"å€‹äººåŒ–ï¼šç®¡ç†å“¡vsä½¿ç”¨è€…"},{id:"saas_c2",text:"æ˜¯å¦æä¾›APIæ–‡ä»¶èˆ‡æ•´åˆæ”¯æ´ï¼Ÿ",checked:!1,suggestion:"æ“´å±•æ€§ï¼šé–‹æ”¾APIã€Webhook"},{id:"saas_c3",text:"å®¢æœå›æ‡‰é€Ÿåº¦æ˜¯å¦å¿«é€Ÿï¼Ÿ",checked:!1,suggestion:"ä¿è­‰ï¼šSLAæ‰¿è«¾ã€å¤šç®¡é“æ”¯æ´"},{id:"saas_c4",text:"æ˜¯å¦æœ‰å®Œæ•´çš„èªªæ˜æ–‡ä»¶èˆ‡å½±ç‰‡æ•™å­¸ï¼Ÿ",checked:!1,suggestion:"è‡ªåŠ©ï¼šçŸ¥è­˜åº«ã€å½±ç‰‡åº«"},{id:"saas_c5",text:"è³‡æ–™å®‰å…¨èˆ‡éš±ç§ä¿è­·æ˜¯å¦æ¸…æ¥šèªªæ˜ï¼Ÿ",checked:!1,suggestion:"ä¿¡ä»»ï¼šèªè­‰æ¨™ç« ã€éš±ç§æ”¿ç­–"}],cognitive:[{id:"saas_cg1",text:"åŠŸèƒ½èˆ‡è¨­å®šæ˜¯å¦éæ–¼è¤‡é›œï¼Œé€ æˆä½¿ç”¨è€…ç†è§£å›°é›£ï¼Ÿ",checked:!1,suggestion:"ç°¡åŒ–ï¼šåˆ†æ­¥è¨­å®šã€é è¨­æ¨¡æ¿"},{id:"saas_cg2",text:"å„€è¡¨æ¿è³‡è¨Šæ˜¯å¦éè¼‰ï¼Œä½¿ç”¨è€…èƒ½å¦èšç„¦é—œéµæ•¸æ“šï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šè³‡è¨Šåˆ†å±¤ã€å¯è‡ªè¨‚è¦–åœ–"},{id:"saas_cg3",text:"ç”¨èªæ˜¯å¦ä¸€è‡´ï¼Ÿæ˜¯å¦å­˜åœ¨å°ˆæ¥­è¡“èªæˆ–ç¿»è­¯å•é¡Œï¼Ÿ",checked:!1,suggestion:"å»ºç«‹ç”¨èªå­—å…¸ã€çµ±ä¸€ç¿»è­¯"},{id:"saas_cg4",text:"æ“ä½œæµç¨‹æ˜¯å¦ç¬¦åˆä½¿ç”¨è€…çš„èªçŸ¥æ¨¡å‹ï¼Ÿ",checked:!1,suggestion:"åƒè€ƒå¸¸è¦‹æ¨¡å¼ã€é™ä½å­¸ç¿’æˆæœ¬"},{id:"saas_cg5",text:"æ˜¯å¦æä¾›è¶³å¤ çš„å¼•å°èˆ‡èªªæ˜ï¼Ÿ",checked:!1,suggestion:"å·¥å…·æç¤ºã€é€æ­¥æ•™å­¸"}],emotional:[{id:"saas_em1",text:"ä½¿ç”¨è€…æ˜¯å¦åœ¨è¨­å®šæˆ–æ“ä½œéç¨‹ä¸­æ„Ÿåˆ°ç„¦æ…®æˆ–ä¸ç¢ºå®šï¼Ÿ",checked:!1,suggestion:"å³æ™‚å›é¥‹ã€æ¸…æ¥šéŒ¯èª¤è¨Šæ¯"},{id:"saas_em2",text:"æ˜¯å¦æœ‰è¨‚é–±æˆ–ä»˜æ¬¾æµç¨‹é€ æˆæŒ«æŠ˜æ„Ÿï¼Ÿ",checked:!1,suggestion:"é€æ˜ï¼šæ¸…æ¥šæ–¹æ¡ˆæ¯”è¼ƒã€ç°¡å–®ä»˜æ¬¾"},{id:"saas_em3",text:"ç­‰å¾…å®¢æœæˆ–æŠ€è¡“æ”¯æ´æ˜¯å¦å°è‡´å¤±æœ›ï¼Ÿ",checked:!1,suggestion:"æ”¹å–„ï¼šå³æ™‚å®¢æœã€å¿«é€Ÿå›è¦†"},{id:"saas_em4",text:"æ˜¯å¦æœ‰äº’å‹•è¨­è¨ˆè®“ä½¿ç”¨è€…æ„Ÿåˆ°è¢«å¿½ç•¥ï¼Ÿ",checked:!1,suggestion:"è¨­è¨ˆï¼šç¢ºèªæ“ä½œæˆåŠŸã€å›é¥‹å‹•ç•«"},{id:"saas_em5",text:"æ˜¯å¦æœ‰æƒ…å¢ƒè¨­è¨ˆè®“ä½¿ç”¨è€…æ„Ÿåˆ°ä¸è¢«å°Šé‡æˆ–ç†è§£ï¼Ÿ",checked:!1,suggestion:"æ–‡åŒ–æ•æ„Ÿè¨­è¨ˆã€åŒ…å®¹æ€§æ–‡æ¡ˆ"}]}},{id:"general",name:"é€šç”¨æ¨¡æ¿",icon:"ğŸ“‹",desc:"åŸºç¤ç—›é»æª¢æŸ¥",template:{process:[{id:"p1",text:"è¨»å†Š/ç™»å…¥æµç¨‹æ˜¯å¦éæ–¼è¤‡é›œæˆ–æ­¥é©Ÿéå¤šï¼Ÿ",checked:!1,suggestion:"å»ºè­°ï¼šç¤¾ç¾¤ç™»å…¥ã€æ¸›å°‘å¿…å¡«æ¬„ä½"},{id:"p2",text:"ä½¿ç”¨è€…èƒ½å¦æ¸…æ¥šç†è§£ä¸‹ä¸€æ­¥è©²åšä»€éº¼ï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šæ¸…æ™°CTAã€å¼•å°æç¤º"},{id:"p3",text:"å®Œæˆæ ¸å¿ƒä»»å‹™éœ€è¦ç¶“éå¹¾å€‹æ­¥é©Ÿï¼Ÿæ˜¯å¦å¯ä»¥ç°¡åŒ–ï¼Ÿ",checked:!1,suggestion:"ç²¾ç°¡ï¼š3æ­¥é©Ÿå…§å®Œæˆä¸»è¦ä»»å‹™"},{id:"p4",text:"éŒ¯èª¤è™•ç†æ©Ÿåˆ¶æ˜¯å¦æ˜ç¢ºï¼Ÿä½¿ç”¨è€…çŸ¥é“å¦‚ä½•ä¿®æ­£éŒ¯èª¤å—ï¼Ÿ",checked:!1,suggestion:"å‹å–„ï¼šå…·é«”éŒ¯èª¤è¨Šæ¯ã€ä¿®æ­£å»ºè­°"},{id:"p5",text:"æ˜¯å¦æœ‰ä¸å¿…è¦çš„ç¢ºèªæ­¥é©Ÿæˆ–é‡è¤‡æ“ä½œï¼Ÿ",checked:!1,suggestion:"æµæš¢ï¼šæ¸›å°‘æ‘©æ“¦é»"}],interface:[{id:"i1",text:"CTA æŒ‰éˆ•æ˜¯å¦è¶³å¤ æ˜é¡¯ï¼Ÿä½ç½®æ˜¯å¦ç¬¦åˆä½¿ç”¨è€…é æœŸï¼Ÿ",checked:!1,suggestion:"è¨­è¨ˆï¼šå°æ¯”è‰²ã€Få‹é–±è®€è·¯å¾‘"},{id:"i2",text:"å°è¦½åˆ—æ˜¯å¦æ¸…æ™°ï¼Ÿä½¿ç”¨è€…èƒ½å¦å¿«é€Ÿæ‰¾åˆ°ç›®æ¨™åŠŸèƒ½ï¼Ÿ",checked:!1,suggestion:"çµæ§‹ï¼šæ‰å¹³åŒ–ã€æœå°‹åŠŸèƒ½"},{id:"i3",text:"è¡¨å–®è¨­è¨ˆæ˜¯å¦å‹å–„ï¼Ÿæ¬„ä½æ¨™ç±¤æ˜¯å¦æ¸…æ¥šï¼Ÿ",checked:!1,suggestion:"æ˜“ç”¨ï¼šå…§åµŒæ¨™ç±¤ã€å³æ™‚é©—è­‰"},{id:"i4",text:"è¦–è¦ºå±¤ç´šæ˜¯å¦åˆç†ï¼Ÿé‡è¦è³‡è¨Šæ˜¯å¦çªå‡ºï¼Ÿ",checked:!1,suggestion:"è¦–è¦ºï¼šå¤§å°ã€é¡è‰²ã€ä½ç½®"},{id:"i5",text:"è¡Œå‹•è£ç½®ä¸Šçš„å¯é»æ“Šå€åŸŸæ˜¯å¦å¤ å¤§ï¼ˆè‡³å°‘ 44Ã—44pxï¼‰ï¼Ÿ",checked:!1,suggestion:"è§¸æ§ï¼šè¶³å¤ é»æ“Šå€åŸŸ"}],context:[{id:"c1",text:"ä½¿ç”¨æƒ…å¢ƒæ˜¯å¦ç¬¦åˆç›®æ¨™ä½¿ç”¨è€…çš„çœŸå¯¦éœ€æ±‚ï¼Ÿ",checked:!1,suggestion:"ç”¨æˆ¶ç ”ç©¶ï¼šè¨ªè«‡ã€è§€å¯Ÿ"},{id:"c2",text:"æ˜¯å¦è€ƒæ…®åˆ°ä¸åŒè£ç½®ï¼ˆæ‰‹æ©Ÿ/å¹³æ¿/æ¡Œæ©Ÿï¼‰çš„ä½¿ç”¨æƒ…å¢ƒï¼Ÿ",checked:!1,suggestion:"éŸ¿æ‡‰å¼ï¼šå„å°ºå¯¸æ¸¬è©¦"},{id:"c3",text:"é¦–æ¬¡ä½¿ç”¨è€…æ˜¯å¦èƒ½ç†è§£ç”¢å“åƒ¹å€¼èˆ‡ä½¿ç”¨æ–¹æ³•ï¼Ÿ",checked:!1,suggestion:"æ¸…æ™°ï¼šåƒ¹å€¼ä¸»å¼µã€å¼•å°æµç¨‹"},{id:"c4",text:"æ˜¯å¦æœ‰è€ƒæ…®åˆ°ç¶²è·¯ä¸ç©©å®šæˆ–è¼‰å…¥ç·©æ…¢çš„æƒ…æ³ï¼Ÿ",checked:!1,suggestion:"é«”é©—ï¼šé›¢ç·šæ¨¡å¼ã€éª¨æ¶å±"},{id:"c5",text:"å¤šèªç³»ä½¿ç”¨è€…æ˜¯å¦èƒ½é †æš¢ä½¿ç”¨ï¼Ÿï¼ˆä¸­è‹±æ–‡åˆ‡æ›ã€æ–‡å­—é•·åº¦ï¼‰",checked:!1,suggestion:"åœ‹éš›åŒ–ï¼ši18nã€å½ˆæ€§å¸ƒå±€"}],cognitive:[{id:"cg1",text:"è³‡è¨Šæ˜¯å¦éå¤šï¼Œé€ æˆä½¿ç”¨è€…ç„¡æ³•èšç„¦ï¼Ÿ",checked:!1,suggestion:"åˆ†æ®µå‘ˆç¾ã€é€æ­¥é¡¯ç¤º"},{id:"cg2",text:"è³‡è¨Šæ¶æ§‹æ˜¯å¦æ¸…æ™°ï¼Ÿä½¿ç”¨è€…èƒ½å¦å¿«é€Ÿç†è§£å±¤ç´šï¼Ÿ",checked:!1,suggestion:"å„ªåŒ–ï¼šå¡ç‰‡åˆ†é¡ã€æ¨¹ç‹€çµæ§‹"},{id:"cg3",text:"ç”¨èªæ˜¯å¦ä¸€è‡´ï¼Ÿæ˜¯å¦å­˜åœ¨å°ˆæ¥­è¡“èªæˆ–ç¿»è­¯å•é¡Œï¼Ÿ",checked:!1,suggestion:"å»ºç«‹ç”¨èªå­—å…¸ã€çµ±ä¸€ç¿»è­¯"},{id:"cg4",text:"æ“ä½œæµç¨‹æ˜¯å¦ç¬¦åˆä½¿ç”¨è€…çš„èªçŸ¥æ¨¡å‹ï¼Ÿ",checked:!1,suggestion:"åƒè€ƒå¸¸è¦‹æ¨¡å¼ã€é™ä½å­¸ç¿’æˆæœ¬"},{id:"cg5",text:"æ˜¯å¦æä¾›è¶³å¤ çš„å¼•å°èˆ‡èªªæ˜ï¼Ÿ",checked:!1,suggestion:"å·¥å…·æç¤ºã€é€æ­¥æ•™å­¸"}],emotional:[{id:"em1",text:"ä½¿ç”¨è€…æ˜¯å¦åœ¨æ“ä½œéç¨‹ä¸­æ„Ÿåˆ°ç„¦æ…®æˆ–ä¸ç¢ºå®šï¼Ÿ",checked:!1,suggestion:"å³æ™‚å›é¥‹ã€æ¸…æ¥šéŒ¯èª¤è¨Šæ¯"},{id:"em2",text:"æ˜¯å¦æœ‰éå¤šæ­¥é©Ÿé€ æˆæŒ«æŠ˜æ„Ÿï¼Ÿ",checked:!1,suggestion:"ç°¡åŒ–ï¼šæ¸›å°‘æ­¥é©Ÿã€æä¾›è·³éé¸é …"},{id:"em3",text:"ç­‰å¾…æˆ–é‡è¤‡æ“ä½œæ˜¯å¦å°è‡´å¤±æœ›ï¼Ÿ",checked:!1,suggestion:"æ”¹å–„ï¼šé€²åº¦æç¤ºã€é¿å…é‡è¤‡è¼¸å…¥"},{id:"em4",text:"æ˜¯å¦æœ‰äº’å‹•è¨­è¨ˆè®“ä½¿ç”¨è€…æ„Ÿåˆ°è¢«å¿½ç•¥ï¼Ÿ",checked:!1,suggestion:"è¨­è¨ˆï¼šç¢ºèªæ“ä½œæˆåŠŸã€å›é¥‹å‹•ç•«"},{id:"em5",text:"ç”¢å“å…§å®¹æˆ–æ–‡æ¡ˆæ˜¯å¦è®“ä½¿ç”¨è€…æ„Ÿåˆ°ä¸è¢«å°Šé‡æˆ–ç†è§£ï¼Ÿ",checked:!1,suggestion:"æ–‡åŒ–æ•æ„Ÿè¨­è¨ˆã€åŒ…å®¹æ€§æ–‡æ¡ˆ"}]}}];let userEmail="",userChecklists=[],isPaid=!1,selectedProjectType=null,selectedIndex=-1,searchQuery="",showPriorityOnly=!1,collapsedCategories=new Set,showOnlyIncomplete=!1,showOnlyNeedsWork=!1;const FREE_LIMIT=3;let undoTimer=null,lastDeleted=null;const elements={sidebarFavorites:document.getElementById("favorites-list"),sidebarAll:document.getElementById("all-list"),sidebarSearch:document.getElementById("sidebar-search"),emptyState:document.getElementById("empty-state"),createBtn:document.getElementById("create-checklist-btn"),mobileCreateBtn:document.getElementById("mobile-create-btn"),limitNotice:document.getElementById("limit-notice"),userStatus:document.getElementById("user-status"),userStatusBadge:document.getElementById("user-status-badge"),checklistCount:document.getElementById("checklist-count"),checklistLimit:document.getElementById("checklist-limit"),detailLoading:document.getElementById("detail-loading"),detailTitle:document.getElementById("detail-title"),detailProgressBar:document.getElementById("detail-progress-bar"),detailUpdated:document.getElementById("detail-updated"),detailSections:document.getElementById("detail-sections"),printTitle:document.getElementById("print-checklist-title"),detailEmpty:document.getElementById("detail-empty"),btnDuplicate:document.getElementById("btn-duplicate"),btnPrint:document.getElementById("btn-print"),btnDelete:document.getElementById("btn-delete"),perkPdf:document.getElementById("perk-pdf"),perkAi:document.getElementById("perk-ai"),perkTeam:document.getElementById("perk-team")};let dataReady=!1;function scheduleInitialUIFlush(){setTimeout(()=>{if(!dataReady)try{updateUI()}catch(e){}},800)}async function loadUserData(e){const t=auth.currentUser&&auth.currentUser.uid||"",s=doc(db,"users_by_email",encEmail(e)),n=t?doc(db,"users",t):null;let i=null,a=null;try{const e=await getDoc(s);e.exists()&&(i=e.data())}catch(e){console.warn("è®€å– users_by_email å¤±æ•—ï¼š",e?.message||e)}try{if(n){const e=await getDoc(n);e.exists()&&(a=e.data())}}catch(e){console.warn("è®€å– users/{uid} å¤±æ•—ï¼š",e?.message||e)}const c=i&&Array.isArray(i.uxChecklists)?i.uxChecklists:[],d=a&&Array.isArray(a.uxChecklists)?a.uxChecklists:[];let o="none";c.length>0?(userChecklists=c,o="users_by_email"):d.length>0?(userChecklists=d,o="users_uid"):i?(userChecklists=c,o="users_by_email"):a?(userChecklists=d,o="users_uid"):(userChecklists=[],o="none"),isPaid=Boolean(i&&i.isPaid||a&&a.isPaid),elements.userStatus.textContent=isPaid?"VIPæœƒå“¡":"æ™®é€šæœƒå“¡";try{elements.userStatusBadge&&(elements.userStatusBadge.className=isPaid?"badge-vip":"badge-normal")}catch(e){}if(elements.checklistLimit.textContent=isPaid?"âˆ":3,"users_uid"===o&&userChecklists.length>0)try{await setDoc(s,{email:e,uxChecklists:JSON.parse(JSON.stringify(userChecklists))},{merge:!0}),console.log("â†ª å·²åŒæ­¥æ¸…å–®åˆ° users_by_email")}catch(e){console.warn("åŒæ­¥åˆ° users_by_email å¤±æ•—ï¼ˆå¯å¿½ç•¥ï¼‰ï¼š",e?.message||e)}if("none"===o)try{await setDoc(s,{email:e,uxChecklists:[]},{merge:!0}),console.log("å·²åˆå§‹åŒ–ä½¿ç”¨è€…æ–‡ä»¶ users_by_email")}catch(e){console.error("åˆå§‹åŒ–ä½¿ç”¨è€…æ–‡ä»¶å¤±æ•—ï¼š",e)}updateUI()}function updateUI(){if(elements.detailLoading&&elements.detailLoading.classList.add("d-none"),elements.checklistCount&&(elements.checklistCount.textContent=String(userChecklists.length),elements.checklistCount.classList.remove("placeholder-glow")),elements.userStatus&&elements.userStatus.classList.remove("placeholder-glow"),elements.checklistLimit&&elements.checklistLimit.classList.remove("placeholder-glow"),elements.createBtn){elements.createBtn.disabled=!1;try{elements.createBtn.removeAttribute("disabled")}catch(e){}elements.createBtn.classList.remove("placeholder-glow"),elements.createBtn.innerHTML='<i class="fas fa-plus"></i> æ–°å¢'}if(elements.mobileCreateBtn){elements.mobileCreateBtn.disabled=!1;try{elements.mobileCreateBtn.removeAttribute("disabled")}catch(e){}}const e=!isPaid&&userChecklists.length>=3;elements.createBtn&&(elements.createBtn.disabled=e),elements.mobileCreateBtn&&(elements.mobileCreateBtn.disabled=e),elements.limitNotice&&elements.limitNotice.classList.toggle("d-none",!e),renderSidebar(),renderDetail();[elements.perkPdf,elements.perkAi,elements.perkTeam].forEach(e=>{e&&(isPaid?(e.disabled=!1,e.title=""):(e.disabled=!0,e.title="VIP æœƒå“¡é™å®šåŠŸèƒ½"))})}function computeProgress(e){const t=e.items.process.length+e.items.interface.length+e.items.context.length,s=[...e.items.process,...e.items.interface,...e.items.context].filter(e=>e.checked).length;return{totalItems:t,checkedItems:s,progress:t?Math.round(s/t*100):0}}function renderSidebar(){const e=(searchQuery||"").trim().toLowerCase(),t=elements.sidebarFavorites,s=elements.sidebarAll;if(!t||!s)return;const n=document.getElementById("favorites-loading"),i=document.getElementById("all-list-loading");n&&(n.style.display="none"),i&&(i.style.display="none"),t.style.display="block",s.style.display="block";const a=(e,t)=>{const{progress:s}=computeProgress(e),n=t===selectedIndex?"active":"",i=e.pinned?"pin-btn":"pin-btn inactive",a=projectTypes.find(t=>t.id===e.projectType)||projectTypes.find(e=>"general"===e.id);return`\n          <li class="list-group-item ${n}" data-index="${t}" draggable="true">\n            <div class="d-flex align-items-center gap-2">\n              <button class="btn btn-sm ${i}" data-pin type="button" title="æ”¶è—/å–æ¶ˆæ”¶è—"><i class="fas fa-thumbtack"></i></button>\n              <div class="flex-grow-1" data-select>\n                <div class="d-flex align-items-center gap-2 mb-1">\n                  <span class="list-item-title fw-semibold">${e.name||"æœªå‘½åæ¸…å–®"}</span>\n                  <span class="badge bg-light text-dark" style="font-size: 0.7rem;" title="${a.name}">${a.icon}</span>\n                </div>\n                <div class="d-flex align-items-center gap-2 small text-muted">\n                  <div class="progress flex-grow-1">\n                    <div class="progress-bar ${100===s?"complete":""} bg-secondary" style="width:${s}%"></div>\n                  </div>\n                  <span>${s}%</span>\n                </div>\n              </div>\n              <span class="text-muted small" title="æ‹–æ›³æ’åº"><i class="fas fa-grip-vertical"></i></span>\n            </div>\n          </li>`},c=userChecklists.map((e,t)=>({cl:e,i:t})).filter(({cl:t})=>(t=>!e||(!!(t.name||"").toLowerCase().includes(e)||[...t.items.process,...t.items.interface,...t.items.context].map(e=>(e.text||"").toLowerCase()).some(t=>t.includes(e))))(t)),d=c.filter(({cl:e})=>!!e.pinned),o=c.filter(({cl:e})=>!e.pinned),l=document.getElementById("favorites-count");l&&(l.textContent=d.length);const r=document.getElementById("favorites-empty");d.length>0?(t.innerHTML=d.map(({cl:e,i:t})=>a(e,t)).join(""),r&&r.classList.add("d-none")):(t.innerHTML="",r&&r.classList.remove("d-none")),s.innerHTML=o.map(({cl:e,i:t})=>a(e,t)).join(""),elements.emptyState.classList.toggle("d-none",0!==userChecklists.length);const g=document.getElementById("mobile-favorites-list"),u=document.getElementById("mobile-all-list"),m=document.getElementById("mobile-current-checklist");if(g&&u&&m){const e=(e,t)=>{const{progress:s}=computeProgress(e),n=t===selectedIndex?"active":"",i=projectTypes.find(t=>t.id===e.projectType)||projectTypes.find(e=>"general"===e.id);return`\n            <li class="dropdown-item ${n}" data-mobile-index="${t}">\n              <div class="d-flex align-items-center gap-2 w-100">\n                <span class="badge bg-light text-dark" style="font-size: 0.7rem;" title="${i.name}">${i.icon}</span>\n                <div class="flex-grow-1">\n                  <div class="fw-semibold">${e.name||"æœªå‘½åæ¸…å–®"}</div>\n                  <div class="d-flex align-items-center gap-2 small text-muted">\n                    <div class="progress flex-grow-1" style="height: 4px;">\n                      <div class="progress-bar ${100===s?"complete":""} bg-secondary" style="width:${s}%"></div>\n                    </div>\n                    <span>${s}%</span>\n                  </div>\n                </div>\n              </div>\n            </li>`};if(d.length>0?g.innerHTML=d.map(({cl:t,i:s})=>e(t,s)).join(""):g.innerHTML='<li class="dropdown-item disabled text-muted">å°šç„¡æ”¶è—æ¸…å–®</li>',u.innerHTML=o.map(({cl:t,i:s})=>e(t,s)).join(""),selectedIndex>=0&&selectedIndex<userChecklists.length){const e=userChecklists[selectedIndex];m.textContent=e.name||"æœªå‘½åæ¸…å–®"}document.querySelectorAll("[data-mobile-index]").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const s=parseInt(e.dataset.mobileIndex,10);s>=0&&s<userChecklists.length&&(selectedIndex=s,renderDetail(),renderSidebar())})})}attachSidebarEvents()}function renderDetail(){const e=selectedIndex,t=document.getElementById("detail-toolbar"),s=document.getElementById("detail-meta");if(e<0||e>=userChecklists.length){t&&t.classList.add("d-none"),s&&s.classList.add("d-none"),elements.printTitle&&(elements.printTitle.textContent=""),elements.detailSections&&(elements.detailSections.innerHTML='\n            <div class="text-center py-5" id="detail-empty">\n              <i class="fas fa-clipboard-list fa-3x text-muted mb-3"></i>\n              <h5 class="text-muted">é–‹å§‹æ‚¨çš„ç¬¬ä¸€å€‹ UX å°ˆæ¡ˆ</h5>\n              <p class="text-muted mb-4">é¸æ“‡å°ˆæ¡ˆé¡å‹ï¼Œç³»çµ±å°‡è‡ªå‹•è¼‰å…¥å°ˆæ¥­çš„ç—›é»æª¢æŸ¥æ¨¡æ¿</p>\n              <button class="btn btn-primary-shari btn-lg" onclick="document.getElementById(\'create-checklist-btn\').click() || document.getElementById(\'mobile-create-btn\').click()">\n                <i class="fas fa-plus me-2"></i>å»ºç«‹ç¬¬ä¸€å¼µæ¸…å–®\n              </button>\n            </div>');const e=document.getElementById("detail-project-type");return void(e&&(e.textContent=""))}const n=userChecklists[e],i=projectTypes.find(e=>e.id===n.projectType)||projectTypes.find(e=>"general"===e.id);n&&n.items&&i&&i.template&&["cognitive","emotional"].forEach(e=>{Array.isArray(n.items[e])||(n.items[e]=i.template[e].map(e=>({...e})))});const{totalItems:a,checkedItems:c,progress:d}=computeProgress(n),o=document.getElementById("detail-project-type");o&&(o.textContent=`${i.icon} ${i.name}`),t&&t.classList.remove("d-none"),s&&s.classList.remove("d-none"),elements.detailTitle&&(elements.detailTitle.value=n.name||""),elements.printTitle&&(elements.printTitle.textContent=n.name||""),elements.detailProgressBar&&(elements.detailProgressBar.style.width=d+"%"),elements.detailUpdated&&(elements.detailUpdated.textContent=new Date(n.updatedAt).toLocaleDateString("zh-TW"));const l=(t,s,i)=>{const a=n.items[i];let c=a;showPriorityOnly&&(c=c.filter(e=>e.priority)),showOnlyIncomplete&&(c=c.filter(e=>!e.checked)),showOnlyNeedsWork&&(c=c.filter(e=>e.severity&&"none"!==e.severity));const d=a.length,o=a.filter(e=>e.checked).length,l=d?Math.round(o/d*100):0,r=a.filter(e=>e.custom).length,g=collapsedCategories.has(i);return`\n        <div class="checklist-section" data-category="${i}">\n          <div class="section-title d-flex align-items-center justify-content-between" style="cursor: pointer;" data-toggle-category="${i}">\n            <div class="d-flex align-items-center gap-2">\n              <button class="btn btn-sm btn-link p-0 text-decoration-none collapse-btn" data-toggle-category="${i}">\n                <i class="fas fa-chevron-${g?"right":"down"} text-muted"></i>\n              </button>\n              <div class="section-icon"><i class="${s}"></i></div>\n              <span>${t}</span>\n              <span class="badge bg-light text-muted">${o}/${d}</span>\n            </div>\n            <div class="progress no-print" style="width: 80px; height: 6px;">\n              <div class="progress-bar bg-secondary-shari" role="progressbar" style="width: ${l}%" \n                   aria-valuenow="${l}" aria-valuemin="0" aria-valuemax="100"></div>\n            </div>\n          </div>\n          <div class="category-items ${g?"d-none":""}">\n            ${c.map((t,s)=>((t,s)=>{const n=s.severity||"none",i={none:"æœªè¨­å®š",low:"ä½",medium:"ä¸­",high:"é«˜"},a=s.priority||!1,c=s.note&&s.note.trim(),d=!0===s.custom;return`<div class="checklist-item touch-feedback ${s.checked?"checked":""}" data-cat="${t}" data-item-id="${s.id}">\n          <label class="checkbox-touch-area" for="d-${e}-${s.id}">\n            <input type="checkbox" id="d-${e}-${s.id}" ${s.checked?"checked":""} data-cat="${t}" data-id="${s.id}">\n          </label>\n          <div class="checklist-item-text">\n            <div class="d-flex flex-column flex-md-row align-items-start gap-2 w-100">\n              <span class="flex-grow-1 mb-2 mb-md-0">${s.text}\n                <span class="print-only ms-2">\n                  ${a?'<i class="fas fa-star print-star"></i>':""}\n                  ${"none"!==n?`<span class="print-badge sev-${n}">${i[n]}</span>`:""}\n                </span>\n              </span>\n              <div class="d-flex align-items-center gap-2 flex-shrink-0 no-print item-actions" role="toolbar" aria-label="é …ç›®æ“ä½œ">\n                \x3c!-- Priority star --\x3e\n                <button class="btn btn-icon-shari priority-btn ${a?"active":""}" \n                        data-cat="${t}" data-id="${s.id}" title="æ¨™è¨˜ç‚ºé‡é»" aria-label="æ¨™è¨˜ç‚ºé‡é»">\n                  <i class="fas fa-star ${a?"text-warning":"text-muted"}"></i>\n                </button>\n                \x3c!-- Severity dropdown --\x3e\n                <div class="dropdown d-inline-block">\n                  <button class="btn btn-sm severity-btn ${"none"===n?"btn-outline-secondary":"btn-"+{none:"secondary",low:"success",medium:"warning",high:"danger"}[n]} dropdown-toggle py-0 px-2 btn-chip" \n                          type="button" data-bs-toggle="dropdown" data-severity="${n}" style="font-size: 0.8rem; line-height: 1.4; min-height: 32px; min-width: 52px;">\n                    ${i[n]}\n                  </button>\n                  <ul class="dropdown-menu dropdown-menu-end">\n                    <li><a class="dropdown-item severity-option" href="#" data-cat="${t}" data-id="${s.id}" data-severity="none">æœªè¨­å®š</a></li>\n                    <li><a class="dropdown-item severity-option text-success" href="#" data-cat="${t}" data-id="${s.id}" data-severity="low">ä½</a></li>\n                    <li><a class="dropdown-item severity-option text-warning" href="#" data-cat="${t}" data-id="${s.id}" data-severity="medium">ä¸­</a></li>\n                    <li><a class="dropdown-item severity-option text-danger" href="#" data-cat="${t}" data-id="${s.id}" data-severity="high">é«˜</a></li>\n                  </ul>\n                </div>\n                \x3c!-- Note button --\x3e\n                <button class="btn btn-icon-shari note-btn ${c?"text-primary":"text-muted"}" \n                        data-cat="${t}" data-id="${s.id}" title="æ·»åŠ ç­†è¨˜" aria-label="æ·»åŠ ç­†è¨˜">\n                  <i class="fas fa-sticky-note"></i>\n                </button>\n                \x3c!-- Explanation icon --\x3e\n                ${s.suggestion?`<button class="btn btn-icon-shari text-info suggestion-btn" \n                                           data-suggestion="${encodeURIComponent(s.suggestion)}" title="æŸ¥çœ‹å»ºè­°" aria-label="æŸ¥çœ‹å»ºè­°">\n                  <i class="fas fa-info-circle"></i>\n                </button>`:""}\n                \x3c!-- Delete button (custom items only) --\x3e\n                ${d?`<button class="btn btn-icon-shari text-danger delete-item-btn" \n                                    data-cat="${t}" data-id="${s.id}" title="åˆªé™¤è‡ªå®šç¾©é …ç›®" aria-label="åˆªé™¤è‡ªå®šç¾©é …ç›®">\n                  <i class="fas fa-trash-alt"></i>\n                </button>`:""}\n              </div>\n            </div>\n            ${c?`<div class="item-note mt-1 small text-muted"><i class="fas fa-comment-dots me-1"></i>${s.note}</div>`:""}\n          </div>\n        </div>`})(i,t)).join("")}\n            ${showPriorityOnly?"":`\n            <button class="btn btn-sm btn-outline-secondary-shari mt-2 w-100 add-custom-item-btn no-print" \n                    data-category="${i}">\n              <i class="fas fa-plus me-1"></i>æ–°å¢è‡ªå®šç¾©ç—›é»\n            </button>\n            <div class="text-muted small text-center mt-1 no-print">(æœ€å¤š 5 å€‹ï¼Œå·²ä½¿ç”¨ ${r})</div>\n            `}\n          </div>\n        </div>`},r=[l("æµç¨‹ç—›é»","fas fa-route","process"),l("ä»‹é¢ç—›é»","fas fa-window-maximize","interface"),l("æƒ…å¢ƒç—›é»","fas fa-users","context"),l("èªçŸ¥ç—›é»","fas fa-brain","cognitive"),l("æƒ…ç·’ç—›é»","fas fa-heartbeat","emotional")].join("");if(elements.detailSections.innerHTML=r,document.querySelectorAll(".dropdown-item[data-action]").forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault();const s=t.currentTarget.getAttribute("data-action");"duplicate"===s?await duplicateChecklistWithUI(e):"print"===s?window.print():"delete"===s&&await deleteChecklistWithUI(e)})}),elements.detailSections.querySelectorAll('input[type="checkbox"]').forEach(t=>{t.addEventListener("change",async t=>{const s=t.target.getAttribute("data-cat"),n=t.target.getAttribute("data-id"),i=userChecklists[e].items[s].find(e=>e.id===n);i&&(i.checked=!!t.target.checked,userChecklists[e].updatedAt=(new Date).toISOString(),await saveToFirestore(),showSaveIndicator(),updateUI(),t.target.checked&&checkAchievements(userChecklists[e]))})}),elements.detailSections.querySelectorAll(".priority-btn").forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault();const s=t.currentTarget.getAttribute("data-cat"),n=t.currentTarget.getAttribute("data-id"),i=userChecklists[e].items[s].find(e=>e.id===n);i&&(i.priority=!i.priority,userChecklists[e].updatedAt=(new Date).toISOString(),await saveToFirestore(),showSaveIndicator(),renderDetail())})}),elements.detailSections.querySelectorAll(".severity-option").forEach(t=>{t.addEventListener("click",async t=>{t.preventDefault();const s=t.currentTarget.getAttribute("data-cat"),n=t.currentTarget.getAttribute("data-id"),i=t.currentTarget.getAttribute("data-severity"),a=userChecklists[e].items[s].find(e=>e.id===n);a&&(a.severity=i,userChecklists[e].updatedAt=(new Date).toISOString(),await saveToFirestore(),showSaveIndicator(),renderDetail())})}),elements.detailSections.querySelectorAll(".note-btn").forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();const s=t.currentTarget.getAttribute("data-cat"),n=t.currentTarget.getAttribute("data-id"),i=userChecklists[e].items[s].find(e=>e.id===n);i&&openNoteModal(e,s,n,i.note||"")})}),elements.detailSections.querySelectorAll(".suggestion-btn").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();const t=decodeURIComponent(e.currentTarget.getAttribute("data-suggestion")||"");t&&alert("ğŸ’¡ å»ºè­°ï¼š\n\n"+t)})}),elements.detailSections.querySelectorAll(".delete-item-btn").forEach(t=>{t.addEventListener("click",async t=>{if(t.preventDefault(),!confirm("ç¢ºå®šè¦åˆªé™¤æ­¤è‡ªå®šç¾©é …ç›®å—ï¼Ÿ"))return;const s=t.currentTarget.getAttribute("data-cat"),n=t.currentTarget.getAttribute("data-id"),i=userChecklists[e].items[s].findIndex(e=>e.id===n);-1!==i&&(userChecklists[e].items[s].splice(i,1),userChecklists[e].updatedAt=(new Date).toISOString(),await saveToFirestore(),showSaveIndicator(),renderDetail())})}),elements.detailSections.querySelectorAll(".add-custom-item-btn").forEach(t=>{t.addEventListener("click",t=>{t.preventDefault();const s=t.currentTarget.getAttribute("data-category");addCustomItem(e,s)})}),elements.detailTitle){let t;elements.detailTitle.oninput=s=>{clearTimeout(t),t=setTimeout(async()=>{userChecklists[e].name=(s.target.value||"").trim()||`å°ˆæ¡ˆæ¸…å–® ${e+1}`,userChecklists[e].updatedAt=(new Date).toISOString(),await saveToFirestore(),showSaveIndicator(),renderSidebar()},400)}}const g=document.getElementById("priority-filter-btn");g&&(g.onclick=()=>{showPriorityOnly=!showPriorityOnly,g.classList.toggle("active",showPriorityOnly),renderDetail()});const u=document.getElementById("filter-incomplete-btn");u&&(u.onclick=()=>{if(showOnlyIncomplete=!showOnlyIncomplete,u.classList.toggle("active",showOnlyIncomplete),showOnlyIncomplete){showOnlyNeedsWork=!1;const e=document.getElementById("filter-needs-work-btn");e&&e.classList.remove("active")}renderDetail()});const m=document.getElementById("filter-needs-work-btn");m&&(m.onclick=()=>{if(showOnlyNeedsWork=!showOnlyNeedsWork,m.classList.toggle("active",showOnlyNeedsWork),showOnlyNeedsWork){showOnlyIncomplete=!1;const e=document.getElementById("filter-incomplete-btn");e&&e.classList.remove("active")}renderDetail()});const h=document.getElementById("collapse-all-btn");h&&(h.onclick=()=>{const e=["process","interface","context","cognitive","emotional"];e.every(e=>collapsedCategories.has(e))?(collapsedCategories.clear(),h.innerHTML='<i class="fas fa-compress-alt d-md-none"></i><span class="d-none d-md-inline"><i class="fas fa-compress-alt me-1"></i>æŠ˜ç–Š</span><span class="d-md-none">æŠ˜ç–Š</span>'):(e.forEach(e=>collapsedCategories.add(e)),h.innerHTML='<i class="fas fa-expand-alt d-md-none"></i><span class="d-none d-md-inline"><i class="fas fa-expand-alt me-1"></i>å±•é–‹</span><span class="d-md-none">å±•é–‹</span>'),renderDetail()}),document.querySelectorAll("[data-toggle-category]").forEach(e=>{e.onclick=t=>{t.stopPropagation();const s=e.getAttribute("data-toggle-category");collapsedCategories.has(s)?collapsedCategories.delete(s):collapsedCategories.add(s),renderDetail()}}),elements.btnDuplicate&&(elements.btnDuplicate.onclick=async()=>{const t=elements.btnDuplicate.closest(".dropdown"),s=t?t.querySelector(".dropdown-toggle"):document.querySelector(".dropdown-toggle");if(s){const t=s.querySelector("i"),n=t.className;t.className="fas fa-spinner fa-spin",s.disabled=!0;try{await(window.duplicateChecklistWithUI?window.duplicateChecklistWithUI(e,elements.btnDuplicate):window.duplicateChecklist(e))}finally{t&&(t.className=n),s&&(s.disabled=!1)}}else await(window.duplicateChecklistWithUI?window.duplicateChecklistWithUI(e,elements.btnDuplicate):window.duplicateChecklist(e))}),elements.btnDelete&&(elements.btnDelete.onclick=()=>window.deleteChecklistWithUI?window.deleteChecklistWithUI(e,elements.btnDelete):window.deleteChecklist(e)),elements.btnPrint&&(elements.btnPrint.onclick=()=>window.print&&window.print())}function showAchievement(e,t,s){const n=document.getElementById("achievement-toast"),i=document.getElementById("achievement-title"),a=document.getElementById("achievement-text"),c=document.getElementById("achievement-detail"),d=document.getElementById("achievement-progress-bar");i.innerHTML=t>=100?'<i class="fas fa-trophy me-2"></i>ğŸ‰ å®Œç¾é”æˆï¼':t>=80?'<i class="fas fa-star me-2"></i>âœ¨ å¤ªæ£’äº†ï¼':t>=50?'<i class="fas fa-check-circle me-2"></i>ğŸ‘ åšå¾—å¥½ï¼':'<i class="fas fa-thumbs-up me-2"></i>ğŸ’ª ç¹¼çºŒåŠ æ²¹ï¼',a.textContent=e,c.textContent=s||"",d.style.width="0%",setTimeout(()=>{d.style.width=t+"%",d.style.transition="width 0.8s ease"},100),n.classList.add("show");setTimeout(()=>n.classList.remove("show"),t>=100?6e3:t>=80?5e3:4e3)}function checkAchievements(e){const{totalItems:t,checkedItems:s,progress:n}=computeProgress(e);if(["process","interface","context"].forEach(t=>{const s=e.items[t],n=s.length,i=s.filter(e=>e.checked).length,a=n?Math.round(i/n*100):0;if(100===a&&i>0){showAchievement(`${{process:"æµç¨‹ç—›é»",interface:"ä»‹é¢ç—›é»",context:"æƒ…å¢ƒç—›é»"}[t]}é¡åˆ¥å…¨éƒ¨å®Œæˆï¼`,100,`å·²å®Œæˆ ${i} å€‹é …ç›®`)}else if(a>=80&&a<100){const e=`achievement_${t}_80`;if(!sessionStorage.getItem(e)){sessionStorage.setItem(e,"shown");showAchievement(`${{process:"æµç¨‹ç—›é»",interface:"ä»‹é¢ç—›é»",context:"æƒ…å¢ƒç—›é»"}[t]}å¿«å®Œæˆäº†ï¼`,a,`é‚„å‰© ${n-i} å€‹é …ç›®`)}}}),100===n&&t>0)showAchievement("æ­å–œï¼æ‰€æœ‰ç—›é»éƒ½å·²æª¢æŸ¥å®Œæˆ",100,`å…±å®Œæˆ ${t} å€‹é …ç›®`);else if(n>=75&&n<100){const e="achievement_overall_75";sessionStorage.getItem(e)||(sessionStorage.setItem(e,"shown"),showAchievement("è¶…éå››åˆ†ä¹‹ä¸‰äº†ï¼",n,`å·²å®Œæˆ ${s}/${t} å€‹é …ç›®`))}else if(n>=50&&n<75){const e="achievement_overall_50";sessionStorage.getItem(e)||(sessionStorage.setItem(e,"shown"),showAchievement("å·²å®Œæˆä¸€åŠï¼ç¹¼çºŒåŠ æ²¹",n,`å·²å®Œæˆ ${s}/${t} å€‹é …ç›®`))}}function showSaveIndicator(){const e=document.getElementById("save-icon");e&&(e.classList.remove("d-none"),setTimeout(()=>{e.classList.add("d-none")},2e3));const t=document.getElementById("save-indicator");t&&(t.classList.remove("show"),t.offsetWidth,t.classList.add("show"),setTimeout(()=>{t.classList.remove("show")},2e3))}function showUndoToast(e,t){clearTimeout(undoTimer);const s=document.getElementById("undo-toast"),n=document.getElementById("undo-text"),i=document.getElementById("undo-btn");n.textContent=e,s.classList.add("show"),i.onclick=()=>{clearTimeout(undoTimer),s.classList.remove("show"),"function"==typeof t&&t()},undoTimer=setTimeout(()=>{s.classList.remove("show")},5e3)}function attachSidebarEvents(){document.getElementById("checklistSidebar");const e=e=>{e&&(e.querySelectorAll("li.list-group-item").forEach(e=>{const t=e.querySelector("[data-select]");t&&(t.onclick=()=>{selectedIndex=parseInt(e.dataset.index),renderSidebar(),renderDetail()});const s=e.querySelector("[data-pin]");s&&(s.onclick=async t=>{t.stopPropagation();const n=parseInt(e.dataset.index),i=s.querySelector("i"),a=i.className;i.className="fas fa-spinner fa-spin",s.disabled=!0;const c=userChecklists[n].pinned;userChecklists[n].pinned=!userChecklists[n].pinned,userChecklists[n].updatedAt=(new Date).toISOString();try{await saveToFirestore(),showSaveIndicator(),renderSidebar()}catch(e){console.error("Pin toggle failed:",e),userChecklists[n].pinned=c,alert("æ”¶è—ç‹€æ…‹æ›´æ–°å¤±æ•—ï¼Œè«‹é‡è©¦"),renderSidebar()}finally{i&&(i.className=a),s.disabled=!1}}),e.addEventListener("dragstart",()=>{e.classList.add("dragging")}),e.addEventListener("dragend",async()=>{e.classList.remove("dragging");const t=[],s=e=>{e.querySelectorAll("li.list-group-item").forEach(e=>{t.push(parseInt(e.dataset.index))})};s(elements.sidebarFavorites),s(elements.sidebarAll);const n=t.map(e=>userChecklists[e]);userChecklists=n,selectedIndex=Math.max(0,Math.min(selectedIndex,userChecklists.length-1)),await saveToFirestore(),renderSidebar()})}),e.addEventListener("dragover",t=>{t.preventDefault();const s=e.querySelector(".dragging"),n=(i=e,a=t.clientY,[...i.querySelectorAll("li.list-group-item:not(.dragging)")].reduce((e,t)=>{const s=t.getBoundingClientRect(),n=a-s.top-s.height/2;return n<0&&n>e.offset?{offset:n,element:t}:e},{offset:Number.NEGATIVE_INFINITY}).element);var i,a;s&&(null==n?e.appendChild(s):e.insertBefore(s,n))}))};e(elements.sidebarFavorites),e(elements.sidebarAll),elements.sidebarSearch&&(elements.sidebarSearch.oninput=e=>{searchQuery=e.target.value||"",renderSidebar()});const t=document.getElementById("mobile-sidebar-search");t&&(t.oninput=e=>{searchQuery=e.target.value||"",renderSidebar()})}function initProjectTypeModal(){const e=document.getElementById("project-type-grid"),t=document.getElementById("project-type-loading");e.innerHTML=projectTypes.map(e=>`\n        <div class="project-type-card" data-type="${e.id}" onclick="selectProjectType('${e.id}')">\n          <div class="project-type-icon">${e.icon}</div>\n          <div class="project-type-name">${e.name}</div>\n          <div class="project-type-desc">${e.desc}</div>\n        </div>\n      `).join(""),t&&(t.style.display="none"),e.style.display="grid"}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",scheduleInitialUIFlush):scheduleInitialUIFlush(),elements.detailSections.addEventListener("click",e=>{const t=e.target.closest(".suggestion-pill");if(t)try{const e=decodeURIComponent(t.dataset.suggestion||"");alert(e||"ï¼ˆç„¡å»ºè­°å…§å®¹ï¼‰")}catch(e){alert("ç„¡æ³•è®€å–å»ºè­°å…§å®¹")}else;}),window.selectProjectType=function(e){selectedProjectType=e,document.querySelectorAll(".project-type-card").forEach(t=>{t.classList.toggle("selected",t.dataset.type===e)})};const openCreateModal=()=>{if(!isPaid&&userChecklists.length>=3)return void alert("å·²é”æ™®é€šæœƒå“¡ä¸Šé™ï¼ˆ3 å¼µæ¸…å–®ï¼‰\n\nå‡ç´šåˆ° VIP æœƒå“¡ä»¥å»ºç«‹ç„¡é™æ•¸é‡æ¸…å–®ï¼");selectedProjectType=null;new bootstrap.Modal(document.getElementById("projectTypeModal")).show()};elements.createBtn&&elements.createBtn.addEventListener("click",openCreateModal),elements.mobileCreateBtn&&elements.mobileCreateBtn.addEventListener("click",openCreateModal),document.getElementById("confirm-project-type").addEventListener("click",async()=>{if(!selectedProjectType)return void alert("è«‹é¸æ“‡å°ˆæ¡ˆé¡å‹");const e=document.getElementById("confirm-project-type"),t=document.querySelector("#projectTypeModal .btn.btn-secondary");var s,n;n="å»ºç«‹ä¸­â€¦",(s=e)&&(s.disabled=!0,s.dataset.original=s.innerHTML,s.innerHTML=`<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>${n}`),t&&(t.disabled=!0);const i=projectTypes.find(e=>e.id===selectedProjectType),a={id:Date.now().toString(),name:`${i.name} - ${(new Date).toLocaleDateString("zh-TW")}`,projectType:selectedProjectType,items:JSON.parse(JSON.stringify(i.template)),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),pinned:!1};userChecklists.push(a),await saveToFirestore(),showSaveIndicator(),e.blur();const c=bootstrap.Modal.getInstance(document.getElementById("projectTypeModal"));c&&c.hide(),setTimeout(()=>{selectedIndex=userChecklists.length-1,updateUI()},120),setTimeout(()=>{(e=>{e&&e.dataset.original&&(e.innerHTML=e.dataset.original,e.disabled=!1,delete e.dataset.original)})(e),t&&(t.disabled=!1)},150)}),window.toggleCheckbox=async(e,t,s)=>{const n=userChecklists[e]?.items?.[t]?.find(e=>e.id===s);if(!n)return;const i=n.checked;n.checked=!n.checked,userChecklists[e].updatedAt=(new Date).toISOString();const{progress:a}=computeProgress(userChecklists[e]);!i&&a>=80&&a<100?showAchievement("ğŸ‰ å¤ªæ£’äº†ï¼ä½ å·²ç¶“å®Œæˆ 80% çš„ç—›é»æª¢æŸ¥"):100!==a||i||showAchievement("ğŸ† å®Œç¾ï¼æ‰€æœ‰ç—›é»æª¢æŸ¥å®Œæˆï¼Œä½ å·²ç¶“æ˜¯ UX è§€å¯Ÿé«˜æ‰‹"),await saveToFirestore(),showSaveIndicator(),updateUI()},window.deleteChecklist=async e=>{if(!confirm("ç¢ºå®šè¦åˆªé™¤æ­¤æ¸…å–®å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚"))return;const t=userChecklists[e],s=e;userChecklists.splice(e,1),selectedIndex=Math.max(0,Math.min(selectedIndex,userChecklists.length-1)),updateUI(),lastDeleted={data:t,index:s},showUndoToast(`å·²åˆªé™¤ã€Œ${t?.name||"æ¸…å–®"}ã€`,async()=>{const e=Math.min(lastDeleted.index,userChecklists.length);userChecklists.splice(e,0,lastDeleted.data),lastDeleted=null,updateUI();try{await saveToFirestore(),showSaveIndicator()}catch(e){}}),saveToFirestore().then(()=>{showSaveIndicator()}).catch(e=>{console.warn("åˆªé™¤åŒæ­¥å¤±æ•—ï¼š",e?.message||e)})},window.deleteChecklistWithUI=async(e,t)=>{if(!confirm("ç¢ºå®šè¦åˆªé™¤æ­¤æ¸…å–®å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚"))return;const s=userChecklists[e],n=e;userChecklists.splice(e,1),updateUI(),lastDeleted={data:s,index:n},showUndoToast(`å·²åˆªé™¤ã€Œ${s?.name||"æ¸…å–®"}ã€`,async()=>{const e=Math.min(lastDeleted.index,userChecklists.length);userChecklists.splice(e,0,lastDeleted.data),lastDeleted=null,updateUI();try{await saveToFirestore(),showSaveIndicator()}catch(e){}}),saveToFirestore().then(()=>{showSaveIndicator()}).catch(e=>{console.warn("åˆªé™¤åŒæ­¥å¤±æ•—ï¼š",e?.message||e)})};const setupVIPPerkHandlers=()=>{const e=document.getElementById("perk-pdf"),t=document.getElementById("perk-ai"),s=document.getElementById("perk-team");e&&e.addEventListener("click",()=>{isPaid?alert("PDF åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­â€¦"):alert("å‡ç´šåˆ° VIP æœƒå“¡ä»¥ä½¿ç”¨ PDF åŒ¯å‡ºåŠŸèƒ½ï¼\n\nç«‹å³å‡ç´šï¼šå‰å¾€ã€Œå®šåƒ¹æ–¹æ¡ˆã€é é¢")}),t&&t.addEventListener("click",()=>{isPaid?alert("AI å„ªåŒ–å»ºè­°åŠŸèƒ½é–‹ç™¼ä¸­â€¦"):alert("å‡ç´šåˆ° VIP æœƒå“¡ä»¥ä½¿ç”¨ AI å„ªåŒ–å»ºè­°åŠŸèƒ½ï¼\n\nç«‹å³å‡ç´šï¼šå‰å¾€ã€Œå®šåƒ¹æ–¹æ¡ˆã€é é¢")}),s&&s.addEventListener("click",()=>{isPaid?alert("åœ˜éšŠå”ä½œåŠŸèƒ½é–‹ç™¼ä¸­â€¦"):alert("å‡ç´šåˆ° VIP æœƒå“¡ä»¥ä½¿ç”¨åœ˜éšŠå”ä½œåŠŸèƒ½ï¼\n\nç«‹å³å‡ç´šï¼šå‰å¾€ã€Œå®šåƒ¹æ–¹æ¡ˆã€é é¢")})};function attachEventListeners(){}function openNoteModal(e,t,s,n){const i=new bootstrap.Modal(document.getElementById("noteModal")),a=document.getElementById("note-textarea"),c=document.getElementById("save-note-btn");a.value=n||"";const d=c.cloneNode(!0);c.parentNode.replaceChild(d,c),d.addEventListener("click",async()=>{const n=d.querySelector(".btn-text"),c=d.querySelector(".btn-spinner");n.classList.add("d-none"),c.classList.remove("d-none"),d.disabled=!0;try{const n=a.value.trim(),c=userChecklists[e].items[t].find(e=>e.id===s);c&&(c.note=n,userChecklists[e].updatedAt=(new Date).toISOString(),await saveToFirestore(),showSaveIndicator(),i.hide(),renderDetail())}finally{n.classList.remove("d-none"),c.classList.add("d-none"),d.disabled=!1}}),i.show()}function addCustomItem(e,t){const s=prompt("è«‹è¼¸å…¥è‡ªå®šç¾©ç—›é»é …ç›®ï¼š");if(!s||!s.trim())return;if(userChecklists[e].items[t].filter(e=>e.id.startsWith("custom_")).length>=5)return void alert("æ¯å€‹é¡åˆ¥æœ€å¤šåªèƒ½æ–°å¢ 5 å€‹è‡ªå®šç¾©é …ç›®");const n={id:`custom_${t}_${Date.now()}`,text:s.trim(),checked:!1,suggestion:"",severity:"none",priority:!1,note:"",custom:!0};userChecklists[e].items[t].push(n),userChecklists[e].updatedAt=(new Date).toISOString(),saveToFirestore().then(()=>{showSaveIndicator(),renderDetail()})}async function saveToFirestore(){if(userEmail)try{const e=JSON.parse(JSON.stringify(userChecklists)),t=doc(db,"users_by_email",encEmail(userEmail));(await getDoc(t)).exists()?await updateDoc(t,{uxChecklists:e}):await setDoc(t,{email:userEmail,uxChecklists:e}),console.log("âœ… æ¸…å–®å·²å„²å­˜ (users_by_email)")}catch(e){console.warn("users_by_email å„²å­˜å¤±æ•—ï¼Œå˜—è©¦ users/{uid}ï¼š",e?.message||e);try{const e=auth.currentUser&&auth.currentUser.uid||"";if(!e)throw new Error("No UID for fallback write");const t=JSON.parse(JSON.stringify(userChecklists)),s=doc(db,"users",e);await setDoc(s,{email:userEmail,uxChecklists:t},{merge:!0}),console.log("âœ… æ¸…å–®å·²å„²å­˜ (users/{uid})")}catch(e){console.error("âŒ å„²å­˜éŒ¯èª¤ (å…©è·¯å¾‘çš†å¤±æ•—):",e),console.error("æ¸…å–®è³‡æ–™:",userChecklists),alert("å„²å­˜å¤±æ•—ï¼Œè«‹é‡è©¦\n\néŒ¯èª¤è¨Šæ¯ï¼š"+(e?.message||e))}}else console.warn("âš ï¸ å°šæœªç™»å…¥ï¼Œç„¡æ³•å„²å­˜")}window.duplicateChecklist=async e=>{if(!isPaid&&userChecklists.length>=3)return void alert("å·²é”æ™®é€šæœƒå“¡ä¸Šé™ï¼ˆ3 å¼µæ¸…å–®ï¼‰\n\nå‡ç´šåˆ° VIP æœƒå“¡ä»¥å»ºç«‹ç„¡é™æ•¸é‡æ¸…å–®ï¼");const t=userChecklists[e],s=JSON.parse(JSON.stringify(t));s.id=Date.now().toString(),s.name=`${t.name} (å‰¯æœ¬)`,s.createdAt=(new Date).toISOString(),s.updatedAt=(new Date).toISOString(),s.pinned=!1,userChecklists.push(s),await saveToFirestore(),showSaveIndicator(),selectedIndex=userChecklists.length-1,updateUI()},window.duplicateChecklistWithUI=async(e,t)=>{if(!isPaid&&userChecklists.length>=3)return void alert("å·²é”æ™®é€šæœƒå“¡ä¸Šé™ï¼ˆ3 å¼µæ¸…å–®ï¼‰\n\nå‡ç´šåˆ° VIP æœƒå“¡ä»¥å»ºç«‹ç„¡é™æ•¸é‡æ¸…å–®ï¼");const s=e=>{e&&e.dataset.original&&(e.innerHTML=e.dataset.original,e.disabled=!1,delete e.dataset.original)};var n,i;i="è¤‡è£½ä¸­â€¦",(n=t)&&(n.disabled=!0,n.dataset.original=n.innerHTML,n.innerHTML=`<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>${i}`);try{const n=userChecklists[e],i=JSON.parse(JSON.stringify(n));i.id=Date.now().toString(),i.name=`${n.name} (å‰¯æœ¬)`,i.createdAt=(new Date).toISOString(),i.updatedAt=(new Date).toISOString(),i.pinned=!1,userChecklists.push(i),await saveToFirestore(),showSaveIndicator(),selectedIndex=userChecklists.length-1,updateUI(),s(t)}catch(e){alert("è¤‡è£½å¤±æ•—ï¼Œè«‹é‡è©¦"),s(t)}},onAuthStateChanged(auth,async e=>{e?(userEmail=e.email,await loadUserData(e.email),initProjectTypeModal(),setupVIPPerkHandlers(),dataReady=!0,userChecklists.length>0&&-1===selectedIndex&&(selectedIndex=0),updateUI()):window.location.href="/index.html"});