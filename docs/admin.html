<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>產品管理 | UXShari Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="assets/css/general.css">

  <script src="assets/js/clarity.js" defer></script>

  </head>
<body>

  <div class="admin-header">
    <div class="container">
      <h1><i class="fas fa-tools me-2"></i>產品管理系統</h1>
      <p class="mb-0">新增、編輯和管理您的數位產品</p>
    </div>
  </div>

  <div class="container pb-5">
    
    <!-- 管理員驗證 -->
    <div id="auth-section" class="product-form mb-4">
      <h4 class="mb-3"><i class="fas fa-key me-2"></i>管理員驗證</h4>
      <div class="row g-3">
        <div class="col-md-10">
          <input type="password" class="form-control" id="admin-key-input" 
                 placeholder="請輸入管理員密鑰 (Admin Key)">
        </div>
        <div class="col-md-2">
          <button class="btn btn-primary-shari w-100" id="verify-btn">
            <i class="fas fa-unlock me-2"></i>驗證
          </button>
        </div>
      </div>
      <div class="alert alert-info mt-3 mb-0 small">
        <i class="fas fa-info-circle me-2"></i>
        請使用您的 ADMIN_KEY 進行驗證後才能管理產品
      </div>
    </div>

    <!-- 主要管理區域（驗證後顯示） -->
    <div id="admin-area" class="d-none">
      
      <!-- 新增/編輯產品表單 -->
      <div class="product-form mb-4">
        <h4 class="mb-3">
          <i class="fas fa-plus-circle me-2"></i>
          <span id="form-title">新增產品</span>
        </h4>
        
        <form id="product-form">
          <input type="hidden" id="product-id">
          
          <div class="row g-3">
            <!-- 產品類型 -->
            <div class="col-md-6">
              <label class="form-label">產品類型 *</label>
              <select class="form-select" id="product-type" required>
                <option value="tool">🧰 工具 (Tool)</option>
                <option value="course">📚 課程 (Course)</option>
                <option value="challenge">🎯 挑戰包 (Challenge)</option>
                <option value="resource">📦 資源庫 (Resource)</option>
              </select>
            </div>

            <!-- 產品名稱 -->
            <div class="col-md-6">
              <label class="form-label">產品名稱 *</label>
              <input type="text" class="form-control" id="product-title" required 
                     placeholder="例如：UX 線框圖模板包">
            </div>

            <!-- 產品描述 -->
            <div class="col-12">
              <label class="form-label">產品描述 *</label>
              <textarea class="form-control" id="product-description" rows="3" required
                        placeholder="簡短描述產品內容與價值"></textarea>
            </div>

            <!-- 價格 -->
            <div class="col-md-4">
              <label class="form-label">價格 (USD) *</label>
              <input type="number" class="form-control" id="product-price" 
                     min="0" step="0.01" required placeholder="9.00">
            </div>

            <!-- 類別 -->
            <div class="col-md-4">
              <label class="form-label">類別</label>
              <input type="text" class="form-control" id="product-category" 
                     placeholder="例如：wireframe, persona">
            </div>

            <!-- 難度 -->
            <div class="col-md-4">
              <label class="form-label">難度</label>
              <select class="form-select" id="product-level">
                <option value="beginner">初學者</option>
                <option value="intermediate">中級</option>
                <option value="advanced">進階</option>
              </select>
            </div>

            <!-- Stripe Product ID -->
            <div class="col-md-6">
              <label class="form-label">Stripe Product ID</label>
              <input type="text" class="form-control" id="stripe-product-id" 
                     placeholder="prod_1QKm8xHNWqZ9vYjJ"
                     pattern="prod_[a-zA-Z0-9]+">
              <small class="text-muted">
                <i class="fas fa-info-circle me-1"></i>
                從 <a href="https://dashboard.stripe.com/products" target="_blank">Stripe Dashboard</a> 複製 Product ID
              </small>
            </div>

            <!-- Stripe Price ID -->
            <div class="col-md-6">
              <label class="form-label">Stripe Price ID *</label>
              <input type="text" class="form-control" id="stripe-price-id" required
                     placeholder="price_1QKm8xHNWqZ9vYjJ2L3k4M5n"
                     pattern="price_[a-zA-Z0-9]+">
              <small class="text-danger">
                <i class="fas fa-exclamation-triangle me-1"></i>
                <strong>必填！</strong>必須從 Stripe 實際建立的 Price ID（格式：price_xxxxx）
              </small>
            </div>

            <!-- Stripe 設定提示 -->
            <div class="col-12">
              <div class="alert alert-warning">
                <h6><i class="fas fa-lightbulb me-2"></i>Stripe 設定步驟</h6>
                <ol class="mb-0 small">
                  <li>登入 <a href="https://dashboard.stripe.com/products" target="_blank">Stripe Dashboard</a></li>
                  <li>點擊 <strong>Add product</strong> 建立產品</li>
                  <li>設定名稱、價格、One time 付款</li>
                  <li>儲存後複製 <strong>Product ID</strong> 和 <strong>Price ID</strong></li>
                  <li>貼到上方欄位（Price ID 必填！）</li>
                </ol>
              </div>
            </div>

            <!-- 封面圖 URL -->
            <div class="col-12">
              <label class="form-label">封面圖 URL</label>
              <input type="url" class="form-control" id="cover-image" 
                     placeholder="https://images.unsplash.com/photo-xxxxx">
              <small class="text-info">
                <i class="fas fa-image me-1"></i>
                <strong>建議規格：</strong>1200×800px (3:2 比例) | 格式：WebP/JPG | 大小：&lt;200KB | 
                <a href="https://unsplash.com" target="_blank">Unsplash</a> / 
                <a href="https://www.pexels.com" target="_blank">Pexels</a> 免費圖庫
              </small>
            </div>

            <!-- 下載/內容連結 -->
            <div class="col-md-6">
              <label class="form-label">下載連結 (工具/資源)</label>
              <input type="url" class="form-control" id="download-url" 
                     placeholder="https://...">
            </div>

            <div class="col-md-6">
              <label class="form-label">內容頁連結 (課程/挑戰)</label>
              <input type="url" class="form-control" id="content-url" 
                     placeholder="https://...">
            </div>

            <!-- 標籤 -->
            <div class="col-12">
              <label class="form-label">標籤 (逗號分隔)</label>
              <input type="text" class="form-control" id="product-tags" 
                     placeholder="beginner, template, figma">
            </div>

            <!-- 課程相關 -->
            <div class="col-md-4">
              <label class="form-label">總單元數 (課程)</label>
              <input type="number" class="form-control" id="total-units" 
                     min="0" value="0">
            </div>

            <div class="col-md-4">
              <label class="form-label">免費單元數</label>
              <input type="number" class="form-control" id="free-units" 
                     min="0" value="0">
            </div>

            <div class="col-md-4">
              <label class="form-label">完成獎勵點數</label>
              <input type="number" class="form-control" id="credits-reward" 
                     min="0" value="0">
            </div>

            <!-- 狀態開關 -->
            <div class="col-md-4">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="is-active" checked>
                <label class="form-check-label" for="is-active">
                  上架狀態
                </label>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="is-featured">
                <label class="form-check-label" for="is-featured">
                  精選推薦
                </label>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="preview-available">
                <label class="form-check-label" for="preview-available">
                  支援預覽
                </label>
              </div>
            </div>

            <!-- 提交按鈕 -->
            <div class="col-12">
              <button type="submit" class="btn btn-primary-shari btn-lg me-2">
                <i class="fas fa-save me-2"></i>
                <span id="submit-btn-text">建立產品</span>
              </button>
              <button type="button" class="btn btn-outline-secondary-shari" id="cancel-btn">
                取消
              </button>
            </div>
          </div>
        </form>
      </div>

      <!-- 產品列表 -->
      <div class="product-form">
        <h4 class="mb-3">
          <i class="fas fa-list me-2"></i>
          現有產品 (<span id="products-count">0</span>)
        </h4>
        
        <div class="mb-3">
          <input type="text" class="form-control" id="search-products" 
                 placeholder="🔍 搜尋產品...">
        </div>

        <div id="products-list">
          <div class="text-center py-5 text-muted">
            <i class="fas fa-spinner fa-spin fa-2x mb-3"></i>
            <p>載入中...</p>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Admin Panel Logic -->
  <script defer src="assets/js/pages/admin.js?v=20251119a"></script>

</body>
</html>
